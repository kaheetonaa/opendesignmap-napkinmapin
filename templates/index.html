<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.12.0/css/ol.css" type="text/css">
    <title>Freehand Drawing</title>
    <style>
      .map {
      position: fixed;
      top: 0;
      left: 0;
      bottom: 0;
      right: 0;
      z-index: -1;
      }
      .form-inline {
      position: fixed;
      bottom: 30px;
      left: 20px; 
      z-index: 0;
      }
      .title {
      position: absolute;
      bottom: 60px;
      left: 20px; 
      z-index: 0;
      }
    </style>
  <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.12.0/build/ol.js"></script>
  </head>
  <body>
    <div id="map" class="map"></div>
    <div class="title">
    <b> Mappin Napkin </b>
    <button id="geojsonbutton">geojson button</button>
  </div>
    <form class="form-inline">
      
      <label for="type">Geometry type &nbsp;</label>
      <select id="type">
        <option value="LineString">LineString</option>
        <option value="Polygon">Polygon</option>
        <option value="Circle">Circle</option>
        <option value="None">None</option>
      </select>
      </form>
<script type="module">

const raster = new ol.layer.Tile({
  source: new ol.source.OSM(),
});

const source = new ol.source.Vector({wrapX: false});

const vector = new ol.layer.Vector({
  source: source,
    style: new ol.style.Style({
    fill: new ol.style.Fill({
      color: 'white'
    }),
    stroke: new ol.style.Stroke({
      color: 'black'
    })
  })
});

const map = new ol.Map({
  layers: [raster, vector],
  target: 'map',
  view: new ol.View({
    center: [-11000000, 4600000],
    zoom: 4,
  }),
});

const typeSelect = document.getElementById('type');

let draw; // global so we can remove it later
function addInteraction() {
  const value = typeSelect.value;
  if (value !== 'None') {
    draw = new ol.interaction.Draw({
      source: source,
      type: typeSelect.value,
      freehand: true,
    });
    map.addInteraction(draw);
  }
}

/**
 * Handle change event.
 */
typeSelect.onchange = function () {
  map.removeInteraction(draw);
  addInteraction();
};

addInteraction();

geojsonbutton.onclick=function() {
    var writer = new ol.format.GeoJSON();
    var geojsonStr = writer.writeFeatures(source.getFeatures());
console.log(geojsonStr);
};


</script>
  </body>
</html>